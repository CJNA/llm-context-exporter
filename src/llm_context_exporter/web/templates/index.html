<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Context Exporter</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="logo">LLM Context Exporter</h1>
                <p class="tagline">Transfer your ChatGPT context to Gemini or local LLMs</p>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Welcome Page -->
            <div id="welcome-page" class="page active">
                <div class="welcome-content">
                    <div class="hero-section">
                        <h2>Export Your ChatGPT Context</h2>
                        <p class="hero-description">
                            Migrate your accumulated domain knowledge and conversation history from ChatGPT 
                            to Google Gemini or local LLMs running via Ollama. All processing happens locally 
                            on your machine for complete privacy.
                        </p>
                    </div>

                    <div class="platform-comparison">
                        <h3>Choose Your Target Platform</h3>
                        <div class="comparison-grid">
                            <div class="platform-card gemini-card">
                                <div class="platform-icon">ü§ñ</div>
                                <h4>Google Gemini</h4>
                                <ul class="platform-features">
                                    <li>Cloud-based processing</li>
                                    <li>Easy setup with Saved Info</li>
                                    <li>Integrated with Google services</li>
                                    <li>Always up-to-date</li>
                                </ul>
                                <div class="platform-note">
                                    <strong>Privacy:</strong> Context stored in Google's cloud
                                </div>
                            </div>
                            
                            <div class="platform-card ollama-card">
                                <div class="platform-icon">üè†</div>
                                <h4>Local LLM (Ollama)</h4>
                                <ul class="platform-features">
                                    <li>Complete privacy (runs locally)</li>
                                    <li>No internet required after setup</li>
                                    <li>Customizable models</li>
                                    <li>No usage limits</li>
                                </ul>
                                <div class="platform-note">
                                    <strong>Privacy:</strong> Everything stays on your machine
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="privacy-notice">
                        <div class="privacy-icon">üîí</div>
                        <div class="privacy-text">
                            <strong>Privacy First:</strong> All processing happens locally on your machine. 
                            Your ChatGPT data never leaves your computer during the export process.
                        </div>
                    </div>

                    <button id="get-started-btn" class="primary-button">Get Started</button>
                </div>
            </div>

            <!-- Upload Page -->
            <div id="upload-page" class="page">
                <div class="page-header">
                    <h2>Upload ChatGPT Export</h2>
                    <p>Upload your ChatGPT data export file (ZIP or JSON format)</p>
                </div>

                <div class="upload-section">
                    <div id="upload-zone" class="upload-zone">
                        <div class="upload-icon">üìÅ</div>
                        <div class="upload-text">
                            <p class="upload-primary">Drag and drop your ChatGPT export file here</p>
                            <p class="upload-secondary">or click to browse</p>
                        </div>
                        <input type="file" id="file-input" accept=".zip,.json" hidden>
                    </div>

                    <div class="upload-info">
                        <h4>How to get your ChatGPT export:</h4>
                        <ol>
                            <li>Go to <a href="https://chatgpt.com/settings" target="_blank">ChatGPT Settings</a></li>
                            <li>Click on "Data controls"</li>
                            <li>Click "Export data"</li>
                            <li>Wait for the email with your export file</li>
                            <li>Upload the ZIP file here</li>
                        </ol>
                    </div>
                </div>

                <div id="upload-progress" class="upload-progress hidden">
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                    <p class="progress-text">Processing your export...</p>
                </div>

                <div id="upload-result" class="upload-result hidden">
                    <div class="result-icon">‚úÖ</div>
                    <div class="result-info">
                        <h4>Export processed successfully!</h4>
                        <div class="result-stats">
                            <span id="conversations-count">0 conversations</span> ‚Ä¢ 
                            <span id="projects-count">0 projects found</span>
                        </div>
                    </div>
                </div>

                <div class="page-actions">
                    <button id="back-to-welcome" class="secondary-button">Back</button>
                    <button id="continue-to-target" class="primary-button" disabled>Continue</button>
                </div>
            </div>

            <!-- Target Selection Page -->
            <div id="target-page" class="page">
                <div class="page-header">
                    <h2>Select Target Platform</h2>
                    <p>Choose where you want to export your context</p>
                </div>

                <div class="target-selection">
                    <div class="target-options">
                        <label class="target-option">
                            <input type="radio" name="target" value="gemini">
                            <div class="target-card">
                                <div class="target-icon">ü§ñ</div>
                                <h4>Google Gemini</h4>
                                <p>Export as text for Gemini Saved Info</p>
                                <ul class="target-details">
                                    <li>Ready-to-paste format</li>
                                    <li>Optimized for Gemini's understanding</li>
                                    <li>Step-by-step setup instructions</li>
                                </ul>
                            </div>
                        </label>

                        <label class="target-option">
                            <input type="radio" name="target" value="ollama">
                            <div class="target-card">
                                <div class="target-icon">üè†</div>
                                <h4>Local LLM (Ollama)</h4>
                                <p>Generate Ollama Modelfile with embedded context</p>
                                <ul class="target-details">
                                    <li>Complete Modelfile generation</li>
                                    <li>Optimized for Qwen models</li>
                                    <li>Setup and test commands included</li>
                                </ul>
                            </div>
                        </label>
                    </div>

                    <div id="ollama-options" class="ollama-options hidden">
                        <h4>Base Model Selection</h4>
                        <select id="base-model-select">
                            <option value="qwen">Qwen (Recommended)</option>
                            <option value="llama2">Llama 2</option>
                            <option value="mistral">Mistral</option>
                            <option value="codellama">Code Llama</option>
                        </select>
                    </div>
                </div>

                <div class="page-actions">
                    <button id="back-to-upload" class="secondary-button">Back</button>
                    <button id="continue-to-review" class="primary-button" disabled>Continue</button>
                </div>
            </div>

            <!-- Review & Filter Page -->
            <div id="review-page" class="page">
                <div class="page-header">
                    <h2>Review & Filter Context</h2>
                    <p>Select which projects and conversations to include</p>
                </div>

                <div class="review-content">
                    <div class="context-preview">
                        <div class="preview-section">
                            <h3>User Profile</h3>
                            <div id="profile-preview" class="preview-content">
                                <div class="loading">Loading profile...</div>
                            </div>
                        </div>

                        <div class="preview-section">
                            <h3>Projects</h3>
                            <div class="filter-controls">
                                <button id="select-all-projects" class="filter-button">Select All</button>
                                <button id="deselect-all-projects" class="filter-button">Deselect All</button>
                            </div>
                            <div id="projects-preview" class="preview-content">
                                <div class="loading">Loading projects...</div>
                            </div>
                        </div>

                        <div class="preview-section">
                            <h3>Technical Context</h3>
                            <div id="technical-preview" class="preview-content">
                                <div class="loading">Loading technical context...</div>
                            </div>
                        </div>
                    </div>

                    <div class="filter-sidebar">
                        <h3>Filters</h3>
                        
                        <div class="filter-group">
                            <h4>Date Range</h4>
                            <div class="date-inputs">
                                <input type="date" id="date-from" placeholder="From">
                                <input type="date" id="date-to" placeholder="To">
                            </div>
                        </div>

                        <div class="filter-group">
                            <h4>Relevance Score</h4>
                            <div class="relevance-slider">
                                <input type="range" id="relevance-min" min="0" max="1" step="0.1" value="0">
                                <div class="slider-labels">
                                    <span>0</span>
                                    <span id="relevance-value">0</span>
                                    <span>1</span>
                                </div>
                            </div>
                        </div>

                        <div class="filter-group">
                            <h4>Exclude Topics</h4>
                            <div id="topic-filters" class="topic-filters">
                                <!-- Topics will be populated dynamically -->
                            </div>
                        </div>

                        <button id="apply-filters" class="primary-button">Apply Filters</button>
                    </div>
                </div>

                <div class="page-actions">
                    <button id="back-to-target" class="secondary-button">Back</button>
                    <button id="continue-to-payment" class="primary-button">Continue</button>
                </div>
            </div>

            <!-- Payment Page -->
            <div id="payment-page" class="page">
                <div class="page-header">
                    <h2>Payment</h2>
                    <p>Complete payment to generate your context export</p>
                </div>

                <div class="payment-content">
                    <div class="payment-info">
                        <div class="pricing-card">
                            <h3>Context Export</h3>
                            <div class="price">$3.00</div>
                            <p class="price-description">One-time payment per export</p>
                            
                            <ul class="payment-features">
                                <li>‚úÖ Complete context extraction</li>
                                <li>‚úÖ Platform-optimized formatting</li>
                                <li>‚úÖ Validation test questions</li>
                                <li>‚úÖ Step-by-step setup instructions</li>
                                <li>‚úÖ All processing stays local</li>
                            </ul>
                        </div>

                        <div class="payment-alternatives">
                            <div class="alternative-option">
                                <h4>Free Alternative</h4>
                                <p>Use the command-line interface for free:</p>
                                <code>pip install llm-context-exporter</code>
                            </div>
                        </div>
                    </div>

                    <div class="payment-form">
                        <div class="email-input">
                            <label for="user-email">Email Address</label>
                            <input type="email" id="user-email" placeholder="your@email.com" required>
                            <p class="email-note">For receipt and beta program eligibility</p>
                        </div>

                        <div id="stripe-payment-element">
                            <!-- Stripe Elements will be mounted here -->
                        </div>

                        <button id="pay-button" class="primary-button" disabled>
                            <span class="button-text">Pay $3.00</span>
                            <span class="button-spinner hidden">Processing...</span>
                        </button>
                    </div>
                </div>

                <div id="beta-user-notice" class="beta-notice hidden">
                    <div class="beta-icon">üéâ</div>
                    <div class="beta-text">
                        <h4>Beta User Detected!</h4>
                        <p>You have free access to all exports. No payment required.</p>
                    </div>
                </div>

                <div class="page-actions">
                    <button id="back-to-review" class="secondary-button">Back</button>
                    <button id="skip-payment" class="primary-button hidden">Continue (Beta User)</button>
                </div>
            </div>

            <!-- Results Page -->
            <div id="results-page" class="page">
                <div class="page-header">
                    <h2>Export Complete!</h2>
                    <p>Your context has been successfully exported</p>
                </div>

                <div class="results-content">
                    <div class="success-message">
                        <div class="success-icon">üéâ</div>
                        <h3>Context Export Successful</h3>
                        <p>Your ChatGPT context has been processed and formatted for <span id="target-platform-name">your target platform</span>.</p>
                    </div>

                    <div class="export-summary">
                        <h4>Export Summary</h4>
                        <div class="summary-stats">
                            <div class="stat">
                                <span class="stat-label">Projects Included:</span>
                                <span id="final-projects-count" class="stat-value">0</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Conversations Processed:</span>
                                <span id="final-conversations-count" class="stat-value">0</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Files Generated:</span>
                                <span id="files-generated-count" class="stat-value">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="download-section">
                        <h4>Download Your Export</h4>
                        <div class="download-options">
                            <button id="download-zip" class="download-button">
                                <span class="download-icon">üì¶</span>
                                <div class="download-info">
                                    <div class="download-title">Download All Files</div>
                                    <div class="download-description">ZIP archive with all generated files</div>
                                </div>
                            </button>

                            <div id="gemini-copy-section" class="copy-section hidden">
                                <button id="copy-gemini-text" class="copy-button">
                                    <span class="copy-icon">üìã</span>
                                    <div class="copy-info">
                                        <div class="copy-title">Copy Gemini Text</div>
                                        <div class="copy-description">Ready to paste into Gemini Saved Info</div>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="instructions-section">
                        <h4>Next Steps</h4>
                        <div id="setup-instructions" class="instructions-content">
                            <!-- Instructions will be populated based on target platform -->
                        </div>
                    </div>

                    <div class="validation-section">
                        <h4>Validation Tests</h4>
                        <p>Use these questions to verify your context was transferred successfully:</p>
                        <div id="validation-questions" class="validation-questions">
                            <!-- Validation questions will be populated -->
                        </div>
                    </div>

                    <div id="feedback-section" class="feedback-section hidden">
                        <h4>Beta Feedback</h4>
                        <p>Help us improve by sharing your experience:</p>
                        <form id="feedback-form">
                            <div class="rating-input">
                                <label>How would you rate this export?</label>
                                <div class="star-rating">
                                    <input type="radio" name="rating" value="5" id="star5">
                                    <label for="star5">‚≠ê</label>
                                    <input type="radio" name="rating" value="4" id="star4">
                                    <label for="star4">‚≠ê</label>
                                    <input type="radio" name="rating" value="3" id="star3">
                                    <label for="star3">‚≠ê</label>
                                    <input type="radio" name="rating" value="2" id="star2">
                                    <label for="star2">‚≠ê</label>
                                    <input type="radio" name="rating" value="1" id="star1">
                                    <label for="star1">‚≠ê</label>
                                </div>
                            </div>
                            <div class="feedback-input">
                                <label for="feedback-text">Additional feedback (optional):</label>
                                <textarea id="feedback-text" rows="4" placeholder="What worked well? What could be improved?"></textarea>
                            </div>
                            <button type="submit" class="primary-button">Submit Feedback</button>
                        </form>
                    </div>
                </div>

                <div class="page-actions">
                    <button id="start-new-export" class="secondary-button">Start New Export</button>
                </div>
            </div>
        </main>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="loading-spinner"></div>
            <p class="loading-message">Processing...</p>
        </div>

        <!-- Toast Notifications -->
        <div id="toast-container" class="toast-container"></div>
    </div>

    <!-- Stripe JS -->
    <script src="https://js.stripe.com/v3/"></script>
    <!-- Main JavaScript -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>